
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hekaya - Premium Clothing Store</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --accent-color: #e74c3c;
      --gold-color: #f39c12;
      --bg-color: #f8f9fa;
      --text-color: #2c3e50;
      --card-bg: #ffffff;
      --border-color: #e9ecef;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --shadow-hover: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    [data-theme="dark"] {
      --primary-color: #ecf0f1;
      --secondary-color: #3498db;
      --accent-color: #e74c3c;
      --gold-color: #f39c12;
      --bg-color: #1a1a1a;
      --text-color: #ecf0f1;
      --card-bg: #2c2c2c;
      --border-color: #444;
      --shadow: 0 4px 6px rgba(255, 255, 255, 0.1);
      --shadow-hover: 0 8px 25px rgba(255, 255, 255, 0.15);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, var(--bg-color) 0%, #e8f4fd 100%);
      color: var(--text-color);
      line-height: 1.6;
      min-height: 100vh;
      transition: all 0.3s ease;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .header {
      background: linear-gradient(135deg, var(--card-bg) 0%, rgba(255,255,255,0.95) 100%);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      z-index: 1000;
      border-bottom: 3px solid var(--gold-color);
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 0;
    }

    .logo {
      font-size: 3rem;
      font-weight: 700;
      background: linear-gradient(45deg, var(--gold-color), #f1c40f, var(--gold-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
      letter-spacing: 2px;
    }

    .nav-buttons {
      display: flex;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .user-email {
      background: var(--gold-color);
      color: white;
      padding: 8px 12px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 500;
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-weight: 500;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-family: inherit;
    }

    .btn-primary {
      background: linear-gradient(45deg, var(--secondary-color), #2980b9);
      color: white;
      box-shadow: var(--shadow);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-hover);
      background: linear-gradient(45deg, #2980b9, var(--secondary-color));
    }

    .btn-secondary {
      background: var(--card-bg);
      color: var(--text-color);
      border: 2px solid var(--border-color);
    }

    .btn-secondary:hover {
      background: var(--secondary-color);
      color: white;
      border-color: var(--secondary-color);
      transform: translateY(-2px);
    }

    .theme-toggle {
      background: linear-gradient(45deg, var(--gold-color), #f1c40f);
      color: white;
      border-radius: 50px;
      padding: 10px 16px;
      font-size: 12px;
      font-weight: 600;
    }

    .hero {
      text-align: center;
      padding: 4rem 0;
      background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(52,152,219,0.1) 100%);
      margin-bottom: 3rem;
    }

    .hero-title {
      font-size: 5rem;
      font-weight: 700;
      background: linear-gradient(45deg, var(--gold-color), #f1c40f, #e67e22);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
      margin-bottom: 1rem;
      letter-spacing: 3px;
    }

    .hero-subtitle {
      font-size: 1.5rem;
      color: var(--text-color);
      opacity: 0.8;
      margin-bottom: 2rem;
    }

    .main-content {
      padding: 2rem 0;
    }

    .hidden {
      display: none;
    }

    .card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow);
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-hover);
    }

    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 2rem;
      margin-bottom: 3rem;
    }

    .product-card {
      background: var(--card-bg);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
      border: 1px solid var(--border-color);
    }

    .product-card:hover {
      transform: translateY(-8px);
      box-shadow: var(--shadow-hover);
    }

    .product-image {
      width: 100%;
      height: 200px;
      object-fit: cover;
      background: linear-gradient(45deg, #f8f9fa, #e9ecef);
    }

    .product-info {
      padding: 1.5rem;
    }

    .product-name {
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--text-color);
    }

    .product-category {
      color: var(--secondary-color);
      font-size: 0.9rem;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }

    .product-price {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--accent-color);
      margin-bottom: 1rem;
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: var(--text-color);
    }

    .form-input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      font-size: 16px;
      background: var(--card-bg);
      color: var(--text-color);
      transition: all 0.3s ease;
      font-family: inherit;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
    }

    .cart-section {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 2rem;
      margin-top: 3rem;
      box-shadow: var(--shadow);
      border: 1px solid var(--border-color);
    }

    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      border-bottom: 1px solid var(--border-color);
      margin-bottom: 1rem;
    }

    .cart-item:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }

    .cart-total {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--accent-color);
      text-align: center;
      margin: 1.5rem 0;
      padding: 1rem;
      background: linear-gradient(45deg, rgba(231, 76, 60, 0.1), rgba(230, 126, 34, 0.1));
      border-radius: 8px;
    }

    .admin-panel {
      display: grid;
      gap: 2rem;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    }

    .section-header {
      font-size: 2rem;
      font-weight: 600;
      margin-bottom: 2rem;
      color: var(--text-color);
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .section-header::before {
      content: '';
      width: 4px;
      height: 2rem;
      background: linear-gradient(45deg, var(--secondary-color), var(--gold-color));
      border-radius: 2px;
    }

    .login-container {
      text-align: center;
      padding: 3rem;
      background: var(--card-bg);
      border-radius: 16px;
      box-shadow: var(--shadow);
      margin: 2rem auto;
      max-width: 500px;
    }

    .google-signin {
      margin: 2rem 0;
      display: flex;
      justify-content: center;
    }

    .footer {
      background: var(--card-bg);
      margin-top: 4rem;
      padding: 3rem 0;
      border-top: 3px solid var(--gold-color);
      box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.1);
    }

    .footer-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 3rem;
      text-align: center;
    }

    .footer-section h3 {
      color: var(--gold-color);
      margin-bottom: 1rem;
      font-weight: 600;
    }

    .footer-section p {
      color: var(--text-color);
      opacity: 0.8;
      margin-bottom: 0.5rem;
    }

    .social-icons {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1rem;
    }

    .social-icon {
      transition: all 0.3s ease;
    }

    .social-icon:hover {
      transform: scale(1.2);
      filter: brightness(1.2);
    }

    @media (max-width: 768px) {
      .hero-title {
        font-size: 3rem;
      }
      
      .logo {
        font-size: 2rem;
      }
      
      .products-grid {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 1rem;
      }
      
      .header-content {
        flex-direction: column;
        gap: 1rem;
      }
      
      .nav-buttons {
        flex-wrap: wrap;
        justify-content: center;
      }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-in {
      animation: fadeInUp 0.6s ease forwards;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="container">
      <div class="header-content">
        <div class="logo">Hekaya</div>
        <nav class="nav-buttons">
          <div id="user-info" class="user-info hidden">
            <span id="user-email-display" class="user-email"></span>
            <button class="btn btn-primary" onclick="showCustomerPanel()">
              üõçÔ∏è Shop Now
            </button>
            <button id="admin-btn" class="btn btn-secondary hidden" onclick="showAdminPanel()">
              ‚öôÔ∏è Admin
            </button>
            <button class="btn theme-toggle" onclick="toggleTheme()">
              üåô Dark
            </button>
            <button class="btn btn-secondary" onclick="signOut()">Logout</button>
          </div>
          <button id="signin-prompt" class="btn btn-primary" onclick="promptSignIn()">
            üîê Sign in with Google
          </button>
        </nav>
      </div>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="hero">
    <div class="container">
      <h1 class="hero-title">Hekaya</h1>
      <p class="hero-subtitle">It all Begins with a Hekaya</p>
      <div style="
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 16px;
        padding: 2rem;
        margin: 2rem auto;
        max-width: 600px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      ">
        <p style="font-size: 1.3rem; color: var(--text-color); margin-bottom: 1rem; font-weight: 500; text-align: center; line-height: 1.6;">
          This store for All the womens and hijab womens
        </p>
        <p style="font-size: 1.2rem; color: var(--gold-color); margin-bottom: 1rem; font-weight: 600; text-align: center;">
          üá™üá¨ This is an Egyptian Store üá™üá¨
        </p>
        <p style="font-size: 1.1rem; color: var(--text-color); opacity: 0.9; font-weight: 400; text-align: center; font-style: italic;">
          We are the granddaughters and grandson of the Famous Actor Ahmed Halawa
        </p>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <main class="main-content">
    <div class="container">
      
      <!-- Login Required -->
      <div id="login-required" class="login-container">
        <h2 style="color: var(--text-color); margin-bottom: 1rem;">Welcome to Hekaya Store!</h2>
        <p style="color: var(--text-color); opacity: 0.8; margin-bottom: 2rem;">
          Please sign in with your Google account to access the store and start shopping.
        </p>
        <div id="g_id_onload"
             data-client_id="1021003501718-q2nq0u1r1fbbqm5kf9av1c9uq6hn0q8c.apps.googleusercontent.com"
             data-context="signin"
             data-ux_mode="popup"
             data-callback="handleCredentialResponse"
             data-auto_prompt="false">
        </div>
        <div class="google-signin">
          <div class="g_id_signin"
               data-type="standard"
               data-shape="rectangular"
               data-theme="filled_blue"
               data-text="signin_with"
               data-size="large"
               data-logo_alignment="left">
          </div>
        </div>
      </div>

      <!-- Admin Panel -->
      <div id="admin-panel" class="hidden">
        <div class="admin-panel">
          <!-- Category Management -->
          <div class="card">
            <h3 class="section-header">üìÇ Manage Categories</h3>
            <div class="form-group">
              <label class="form-label">New Category</label>
              <input type="text" id="new-category" class="form-input" placeholder="Enter category name" />
            </div>
            <button class="btn btn-primary" onclick="addCategory()">Add Category</button>
            <div id="category-list" style="margin-top: 2rem;"></div>
          </div>
          
          <!-- Product Management -->
          <div class="card">
            <h3 class="section-header">‚ûï Add Product</h3>
            <div class="form-group">
              <label class="form-label">Product Name</label>
              <input type="text" id="product-name" class="form-input" placeholder="Enter product name" />
            </div>
            <div class="form-group">
              <label class="form-label">Price ($)</label>
              <input type="number" id="product-price" class="form-input" placeholder="0.00" step="0.01" />
            </div>
            <div class="form-group">
              <label class="form-label">Product Image</label>
              <input type="file" id="product-image" class="form-input" accept="image/*" />
            </div>
            <div class="form-group">
              <label class="form-label">Category</label>
              <select id="product-category" class="form-input"></select>
            </div>
            <button class="btn btn-primary" onclick="addProduct()">Add Product</button>
          </div>
        </div>
      </div>

      <!-- Customer Panel -->
      <div id="customer-panel" class="hidden">
        <h2 class="section-header">üõçÔ∏è Our Products</h2>
        <div id="product-list" class="products-grid"></div>

        <!-- Cart Section -->
        <div class="cart-section">
          <h2 class="section-header">üõí Shopping Cart</h2>
          <div id="cart-list"></div>
          <div id="cart-total" class="cart-total"></div>
          <button class="btn btn-primary" onclick="checkoutCart()" style="width: 100%; font-size: 1.2rem; padding: 16px;">
            üí≥ Checkout Now
          </button>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>Follow Us</h3>
          <div class="social-icons">
            <svg class="social-icon" width="24" height="24" viewBox="0 0 24 24" fill="var(--gold-color)">
              <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
            </svg>
            <svg class="social-icon" width="24" height="24" viewBox="0 0 24 24" fill="var(--gold-color)">
              <path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/>
            </svg>
          </div>
        </div>
        <div class="footer-section">
          <h3>Store Creators</h3>
          <p>Farida</p>
          <p>Habiba</p>
          <p>Renada</p>
        </div>
        <div class="footer-section">
          <h3>Website Creator</h3>
          <p>Youssef</p>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // App state
    const products = JSON.parse(localStorage.getItem("products") || "[]");
    let cart = JSON.parse(localStorage.getItem("cart") || "[]");
    let categories = JSON.parse(localStorage.getItem("categories") || '["Shirts", "Pants", "Accessories"]');
    let currentTheme = localStorage.getItem("theme") || "light";
    
    // User authentication state
    let currentUser = null;
    let isAdmin = false;
    
    // The four authorized admin emails
    const AUTHORIZED_ADMINS = [
      "farida.halawa@gmail.com",
      "habiba.halawa@gmail.com", 
      "renada.halawa@gmail.com",
      "1the.boomer3@gmail.com"
    ];
    
    // Initialize app
    document.addEventListener('DOMContentLoaded', function() {
      initializeTheme();
      checkStoredAuth();
    });
    
    function checkStoredAuth() {
      const storedUser = localStorage.getItem('currentUser');
      if (storedUser) {
        currentUser = JSON.parse(storedUser);
        isAdmin = AUTHORIZED_ADMINS.includes(currentUser.email);
        showAuthenticatedUI();
        showCustomerPanel();
      } else {
        showLoginRequired();
      }
    }
    
    function handleCredentialResponse(response) {
      // Decode the JWT token to get user info
      const payload = JSON.parse(atob(response.credential.split('.')[1]));
      
      currentUser = {
        email: payload.email,
        name: payload.name,
        picture: payload.picture
      };
      
      isAdmin = AUTHORIZED_ADMINS.includes(currentUser.email);
      
      // Store user info
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      
      showAuthenticatedUI();
      showCustomerPanel();
      
      if (isAdmin) {
        alert(`Welcome ${currentUser.name}! You have admin access to manage the store.`);
      } else {
        alert(`Welcome ${currentUser.name}! Enjoy shopping at Hekaya.`);
      }
    }
    
    function showAuthenticatedUI() {
      document.getElementById('login-required').classList.add('hidden');
      document.getElementById('signin-prompt').classList.add('hidden');
      document.getElementById('user-info').classList.remove('hidden');
      document.getElementById('user-email-display').textContent = currentUser.email;
      
      if (isAdmin) {
        document.getElementById('admin-btn').classList.remove('hidden');
      }
    }
    
    function showLoginRequired() {
      document.getElementById('login-required').classList.remove('hidden');
      document.getElementById('signin-prompt').classList.remove('hidden');
      document.getElementById('user-info').classList.add('hidden');
      document.getElementById('customer-panel').classList.add('hidden');
      document.getElementById('admin-panel').classList.add('hidden');
    }
    
    function promptSignIn() {
      if (!currentUser) {
        alert('Please use the Google Sign-In button above to access the store.');
      }
    }
    
    function signOut() {
      currentUser = null;
      isAdmin = false;
      localStorage.removeItem('currentUser');
      
      // Clear Google Sign-In
      if (window.google && window.google.accounts) {
        google.accounts.id.disableAutoSelect();
      }
      
      showLoginRequired();
      alert('You have been signed out successfully.');
    }
    
    function initializeTheme() {
      document.documentElement.setAttribute('data-theme', currentTheme);
      updateThemeButton();
    }
    
    function toggleTheme() {
      currentTheme = currentTheme === "light" ? "dark" : "light";
      document.documentElement.setAttribute('data-theme', currentTheme);
      localStorage.setItem("theme", currentTheme);
      updateThemeButton();
    }
    
    function updateThemeButton() {
      const button = document.querySelector('.theme-toggle');
      if (button) {
        button.innerHTML = currentTheme === "light" ? "üåô Dark" : "‚òÄÔ∏è Light";
      }
    }
    
    function renderProducts() {
      if (!currentUser) return;
      
      const list = document.getElementById("product-list");
      list.innerHTML = "";
      
      if (products.length === 0) {
        list.innerHTML = `
          <div class="card" style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
            <h3 style="color: var(--text-color); margin-bottom: 1rem;">No products available</h3>
            <p style="color: var(--text-color); opacity: 0.7;">Check back later for new arrivals!</p>
          </div>
        `;
        return;
      }
      
      products.forEach((product, index) => {
        const div = document.createElement("div");
        div.className = "product-card fade-in";
        div.innerHTML = `
          <img src="${product.image}" alt="${product.name}" class="product-image" />
          <div class="product-info">
            <div class="product-name">${product.name}</div>
            <div class="product-category">${product.category}</div>
            <div class="product-price">$${parseFloat(product.price).toFixed(2)}</div>
            <button class="btn btn-primary" onclick="addToCart(${index})" style="width: 100%;">
              Add to Cart
            </button>
            ${isAdmin ? `<button class="btn btn-secondary" onclick="removeProduct(${index})" style="width: 100%; margin-top: 0.5rem;">Remove</button>` : ""}
          </div>
        `;
        list.appendChild(div);
      });
    }
    
    function renderCart() {
      if (!currentUser) return;
      
      const list = document.getElementById("cart-list");
      const totalDisplay = document.getElementById("cart-total");
      list.innerHTML = "";
      let total = 0;
      
      if (cart.length === 0) {
        list.innerHTML = `
          <div style="text-align: center; padding: 2rem; color: var(--text-color); opacity: 0.7;">
            <p>Your cart is empty</p>
          </div>
        `;
        totalDisplay.innerHTML = "Total: $0.00";
        return;
      }
      
      cart.forEach((item, index) => {
        const div = document.createElement("div");
        div.className = "cart-item";
        div.innerHTML = `
          <div>
            <strong>${item.name}</strong>
            <div style="font-size: 0.9rem; color: var(--text-color); opacity: 0.7;">${item.category}</div>
          </div>
          <div style="display: flex; align-items: center; gap: 1rem;">
            <span style="font-weight: 600; color: var(--accent-color);">$${parseFloat(item.price).toFixed(2)}</span>
            <button class="btn btn-secondary" onclick="removeFromCart(${index})" style="padding: 6px 12px; font-size: 12px;">Remove</button>
          </div>
        `;
        list.appendChild(div);
        total += parseFloat(item.price);
      });
      totalDisplay.innerHTML = `Total: $${total.toFixed(2)}`;
    }
    
    function addToCart(index) {
      if (!currentUser) {
        alert('Please sign in to add items to cart.');
        return;
      }
      
      cart.push(products[index]);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
      
      const button = event.target;
      const originalText = button.innerHTML;
      button.innerHTML = "‚úì Added!";
      button.style.background = "var(--gold-color)";
      setTimeout(() => {
        button.innerHTML = originalText;
        button.style.background = "";
      }, 1000);
    }
    
    function removeFromCart(index) {
      cart.splice(index, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    }
    
    function renderCategories() {
      const categorySelect = document.getElementById("product-category");
      const categoryList = document.getElementById("category-list");
      
      if (categorySelect) {
        categorySelect.innerHTML = "";
        categories.forEach(category => {
          const option = document.createElement("option");
          option.value = category;
          option.textContent = category;
          categorySelect.appendChild(option);
        });
      }
      
      if (isAdmin && categoryList) {
        categoryList.innerHTML = "<h4 style='margin-bottom: 1rem; color: var(--text-color);'>Current Categories:</h4>";
        categories.forEach((category, index) => {
          const div = document.createElement("div");
          div.style.cssText = "margin-bottom: 0.5rem; display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: var(--bg-color); border-radius: 6px;";
          div.innerHTML = `
            <span style="color: var(--text-color);">${category}</span>
            <button class="btn btn-secondary" onclick="removeCategory(${index})" style="padding: 4px 8px; font-size: 12px;">Remove</button>
          `;
          categoryList.appendChild(div);
        });
      }
    }
    
    function addCategory() {
      if (!isAdmin) {
        alert('Admin access required.');
        return;
      }
      
      const newCategory = document.getElementById("new-category").value.trim();
      if (!newCategory) {
        alert("Please enter a category name.");
        return;
      }
      if (categories.includes(newCategory)) {
        alert("Category already exists.");
        return;
      }
      categories.push(newCategory);
      localStorage.setItem("categories", JSON.stringify(categories));
      document.getElementById("new-category").value = "";
      renderCategories();
    }
    
    function removeCategory(index) {
      if (!isAdmin) {
        alert('Admin access required.');
        return;
      }
      
      const categoryToRemove = categories[index];
      if (!confirm(`Remove category "${categoryToRemove}"? This will also remove all products in this category.`)) return;
      
      categories.splice(index, 1);
      localStorage.setItem("categories", JSON.stringify(categories));
      
      for (let i = products.length - 1; i >= 0; i--) {
        if (products[i].category === categoryToRemove) {
          products.splice(i, 1);
        }
      }
      localStorage.setItem("products", JSON.stringify(products));
      
      renderCategories();
      renderProducts();
    }
    
    function addProduct() {
      if (!isAdmin) {
        alert('Admin access required.');
        return;
      }
      
      const name = document.getElementById("product-name").value.trim();
      const price = document.getElementById("product-price").value.trim();
      const imageFile = document.getElementById("product-image").files[0];
      const category = document.getElementById("product-category").value;
      
      if (!name || !price || !imageFile || !category) {
        alert("Please fill all fields and select an image.");
        return;
      }
      
      const reader = new FileReader();
      reader.onload = function(e) {
        const imageDataUrl = e.target.result;
        products.push({ name, price, image: imageDataUrl, category });
        localStorage.setItem("products", JSON.stringify(products));
        renderProducts();
        
        document.getElementById("product-name").value = "";
        document.getElementById("product-price").value = "";
        document.getElementById("product-image").value = "";
        
        alert("Product added successfully!");
      };
      reader.readAsDataURL(imageFile);
    }
    
    function removeProduct(index) {
      if (!isAdmin) {
        alert('Admin access required.');
        return;
      }
      
      if (!confirm("Remove this product?")) return;
      products.splice(index, 1);
      localStorage.setItem("products", JSON.stringify(products));
      renderProducts();
    }
    
    function showAdminPanel() {
      if (!isAdmin) {
        alert("Access denied. Only authorized administrators can access this panel.");
        return;
      }
      
      document.getElementById("login-required").classList.add("hidden");
      document.getElementById("admin-panel").classList.remove("hidden");
      document.getElementById("customer-panel").classList.add("hidden");
      renderCategories();
      renderProducts();
    }
    
    function showCustomerPanel() {
      if (!currentUser) {
        showLoginRequired();
        return;
      }
      
      document.getElementById("login-required").classList.add("hidden");
      document.getElementById("admin-panel").classList.add("hidden");
      document.getElementById("customer-panel").classList.remove("hidden");
      renderCategories();
      renderProducts();
      renderCart();
    }
    
    function checkoutCart() {
      if (!currentUser) {
        alert('Please sign in to checkout.');
        return;
      }
      
      if (cart.length === 0) {
        alert("Your cart is empty!");
        return;
      }
      
      const total = cart.reduce((acc, item) => acc + parseFloat(item.price), 0).toFixed(2);
      alert(`Thank you for your purchase, ${currentUser.name}! Total: $${total}`);
      cart = [];
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    }
  </script>
</body>
</html>
